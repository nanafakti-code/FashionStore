---
import AdminLayout from "@/layouts/AdminLayout.astro";
import AdminDashboard from "@/components/islands/AdminDashboard";

const section = Astro.url.searchParams.get("section") || "dashboard";
---

<AdminLayout title="Admin Dashboard - FashionStore">
  <AdminDashboard client:load initialSection={section} />
</AdminLayout>

<script>
  import { supabase } from "@/lib/supabase";

  declare global {
    interface Window {
      handleLogout: () => void;
    }
  }

  async function handleLogout() {
    // if (confirm('¿Estás seguro de que deseas cerrar sesión?')) {
    const { error } = await supabase.auth.signOut();
    if (error) console.error("Error signing out:", error);
    window.location.href = "/admin/login";
    // }
  }

  // Hacer la función global
  window.handleLogout = handleLogout;
</script>
